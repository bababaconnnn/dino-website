<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dino. | Login</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;500;600&family=Poppins:wght@200;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="./assets/css/style.css">

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
</head>

<body id="login">
    <div class="popup">
        <div class="logo">
            <img src="./assets/images/logo.svg" alt="">
            <label>The first shopping dinosaurs website in the world!</label>
        </div>
        <div class="content">
            <h5 for="">Sign Up</h5>
            <div class="input_">
                <div class="icon">
                    <img src="./assets/images/mail.svg" alt="">
                </div>
                <input type="text" placeholder="Email address" id="email">
            </div>
            <div class="input_">
                <div class="icon">
                    <img src="./assets/images/pass.svg" alt="">
                </div>
                <input type="password" placeholder="Password" id="password">
            </div>
            <p class="error-text mt-2 d-none" for="signup"></p>
            <div class="btn_">
                <button onclick="submit_()">Create an Account</button>
            </div>
            <div class="create d-flex align-items-center gap-1 justify-content-center mt-3">
                <p>have an account</p>
                <a href="login.html"><p class="bold">Signin Now!</p></a>
            </div>
        </div>
    </div>
</body>

</html>
<script src="./assets/js/script.js"></script>
<script>
    function submit_() {
        let email = $("#email").val()
        let pass = $("#password").val()
        $.ajax({
            type: "POST",
            url: "https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyC9_Bvk9PVb0cwreWTlGP4k12g7MLU2y5E",
            contentType: 'application/json',
            dataType: "json",
            data: JSON.stringify({
                "email": email,
                "password": pass,
                "returnSecureToken": true
            }),
            success: function (data) {
                console.log("token: ", data.idToken);
                // Check for success or handle error
                if (data.error) {
                    alert(data.error.message)
                    console.error('Error:', data.error.message);
                } else {
                    $("p[for=signup].error-text").addClass('d-none')
                    $(".content .input_").removeClass('error-input')
                    console.log(data);
                    window.location.href = 'index.html'
                }
            },
            error: function (jqXHR, textStatus, errorThrown) {
                let msg = jqXHR.responseJSON.error.message
                let errorMessage = "Can't Signup"
                switch (msg) {
                    case 'EMAIL_EXISTS': errorMessage = 'This email exist already.';
                        break;
                    case 'EMAIL_NOT_FOUND': errorMessage = 'This email dose not exist.';
                        break;
                    case 'INVALID_PASSWORD': errorMessage = 'This password dose not exist.';
                        break;
                    case 'WEAK_PASSWORD : Password should be at least 6 characters' : errorMessage = 'Password should be at least 6 characters'
                        break;
                }
                $("p[for=signup].error-text").removeClass('d-none').text(errorMessage)
                $(".content .input_").addClass('error-input')
                // alert(jqXHR.responseJSON.error.message);
                console.error('Request failed:', errorThrown);
            }
        });
        // window.location.href = 'index.html'
    }
</script>